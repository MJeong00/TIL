# IP


## IP
IP란 **Internet Protocol**의 약자로 **인터넷상에서 정보를 주고받는 데 사용하는 규약**이다.   
OSI 네트워크 계층에서 호스트의 **주소지정**과 주고 받는 **데이터에 대한 패킷 분할 및 조립** 기능을 담당한다. 
  
> 인터넷상에서 정보를 주고 받는데 필수로 필요한것 중 하나가 바로 출발지와 목적지 주소이다. 
> 데이터를 요청할 주소, 데이터를 전달해줄 주소처럼 인터넷상에서 고유한 주소 역할을 해주는것이 바로 IP주소이다.   
> 그렇다면 정확한 데이터 전송을 위해서 이 주소는 기기마다 고유해야하는데 혼자서만 가지고 있는 기기만 해도 노트북, 핸드폰, 테블릿 등 여러개의 
> 기기를 가지고 있다. 이런 수많은 주소는 어떻게 관리되는것일까?
  
## IPv4
#### IPv4는 0.0.0.0 ~ 255.255.255.255 까지의 주소를 가지고 있는 IP 주소 체계이다.   
4마디로 구분되며 각 2의 8제곱씩 2의 32제곱, **약 43개의 고유 주소**를 만들 수 있다.    
하지만 인터넷과 기기의 빠른 발전으로 인터넷 사용수가 급증하면서 IPv4의 주소 체계로만은 고유한 주소를 만들어낼 수 없었고
**IP 주소 고갈 문제**가 시작되었다.   

## IPv6
이러한 문제를 해결하기 위해 IPv6 주소 체계가 나왔다. IPv6는 기존의 32비트였던 IPv4와 달리 128비트 크기로 
확장된 인터넷 프로토콜 주소이다. 즉 무한에 가까운 숫자만큼 주소 할당이 가능해진것이다.   
콜론으로 구분하며 **16비트씩 8부분**으로 표시된다.   
`fe80:0230:1077:ffff:0000:0000:ffff:1111`  
IPv6의 등장 덕분에 **무한에 가까운 주소**를 만들어낼 수 있게 된것이다.

||IPv4|IPv6|
|------|---|---|
|주소 길이|32비트|128비트|
|표시 방법|	8비트씩 4부분으로 10진수로 표시|16비트씩 8부분으로 16진수로 표시 |
|주소 개수|약 43억개|2의 128제곱(약 43억 * 43억 * 43억 * 43억) |
   
     
IPv6처럼 아예 새로운 IP체계를 만들어내는 방법도 있지만 이미 있는 IPv4의 주소를 아껴 쓸 수 있는 방법도 나왔는데 
그게 바로 사설 IP 주소와 공인 IP 주소이다.
  
  
## 사설 IP주소와 공유 IP 주소
간단하게 말하면 하나의 사설 IP 주소 밑에 공유 IP 주소를 두는것이다.    
하나의 라우터를 두고 WIFI, 랜선 등을 이용해 여러 기기가 함께 사용하는데  
이 때 **라우터가 가지는 주소가 고유한 주소인 공공 IP 주소(Public IP Address)** 이다.   

그리고 그 안에서 인터넷을 사용하는 개인 기기들이 **라우터 영역 안에서 각각을 구분하기 위해 
사설 IP 주소(Private/Local IP Address)** 를 가지게 된다.  
  
그렇기 때문에 나의 사설 IP 주소는 다른 라우터 내에서의 어떤 기기의 사설 IP 주소와 겹칠 수 있다. 하지만 
사설 IP가 겹친다고 해서 같은 주소라고 볼 수 없다. 해당 기기에 연결된 라우터의 주소까지 더해져야 
비로소 완벽한 주소를 가지 때문이다.

이렇게 **라우터 내에서 연결된 지역 네트워크를 LAN(Local Area Network)** ,  
이런 **LAN들을 연결한 광역 네트워크를 WAN(Wide Area Network)** 라고 한다.  
  
이렇게 하나의 주소에 여러대의 기기를 연결함으로써 개인 PC에는 일일이 고유 주소를 부여하지 않아도 되기때문에
주소 문제를 어느 정도 해결할 수 있었다.

> 그렇다면 사설 IP 주소와 공인 IP 주소를 같이 사용한다면 주소는 어떤식으로 데이터를 받을 수 있는걸까?
   
## 사설 IP 주소와 공인 IP 주소를 사용한 리소스 주고 받기

내가 어떤 서버에 데이터를 요청 할 때 요청을 보내는 주소에는 **사설 IP 주소**가 담기게 된다. 
그러나 **라우터를 거치게 되면서 자동으로 공인 IP 주소로 변경**하여 전송되게 된다. 그리고 이 과정이 가능한 이유는 
바로 라우터에 탑재된 기능중 하나인 **네트워크 주소 변환, NAT(Network Address Translation)때문**이다.
   
1) 개인 기기에서 요청을 보내면 먼저 라우터에 메세지가 도착하고, 
2) 라우터는 NAT기능을 이용해 호스트 주소를 공인 IP 주소로 변경하여 최종 목적지 서버로 전달한다.
3) 해당 서버는 응답 데이터를 요청 들어온 라우터에 반환하고
4) 라우터는 처음 요청했던 개인 기기로 데이터를 보내게 된다.  
  
  
이러한 과정을 통해 주소도 아끼며 데이터를 주고 받을 수 있게 된다. 
